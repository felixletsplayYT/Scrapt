This code is mainly by Bennik2000
I just translated it into java